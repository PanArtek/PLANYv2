---
import Button from '../ui/Button.astro';
---

<section id="o-nas" class="about section-organic relative py-24 overflow-hidden">
  <!-- Organic Background Decorations -->
  <div class="absolute inset-0 pointer-events-none">
    <div class="organic-decoration-1 absolute top-20 left-16 opacity-30 animate-morph"></div>
    <div class="organic-decoration-2 absolute bottom-32 right-20 opacity-25 animate-flow"></div>
    <div class="organic-decoration-3 absolute top-1/2 left-1/4 opacity-20 animate-organic"></div>
  </div>

  <div class="container-custom relative z-10">
    <div class="max-w-6xl mx-auto">
      
      <!-- Modern Section Header with Organic Text Flow -->
      <div class="text-center mb-20 relative">
        <!-- Floating organic accent -->
        <div class="absolute -top-8 left-1/2 transform -translate-x-1/2 w-16 h-4 bg-coral-300 opacity-30 rounded-full animate-float"></div>
        
        <h2 class="font-heading font-bold text-primary-700 mb-8 animate-fade-in" style="font-size: clamp(2.5rem, 6vw, 4rem); line-height: 1.1;">
          O nas
        </h2>
        
        <!-- Text with organic shape breaking monotony -->
        <div class="relative max-w-4xl mx-auto">
          <!-- Organic text flow accent -->
          <div class="absolute -left-8 top-4 w-12 h-12 bg-lavender-200 opacity-40 rounded-full blur-sm animate-pulse-organic"></div>
          
          <p class="text-xl md:text-2xl text-neutral-600 leading-relaxed animate-slide-up">
            Kompleksowy wykonawca wykończeń i instalacji z <span class="text-primary-600 font-semibold">17-letnim doświadczeniem</span>.<br>
            <span class="text-coral-500 font-semibold">Własny zespół 20+ specjalistów</span> we wszystkich branżach eliminuje problemy koordynacji.
          </p>
          
          <!-- Organic accent on the right -->
          <div class="absolute -right-6 bottom-2 w-8 h-8 bg-gold-200 opacity-50 rounded-full animate-flow"></div>
        </div>
      </div>

      <!-- Modern USPs with Organic Cards -->
      <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8 mb-20">
        
        <!-- USP 1: Wizja lokalna -->
        <div class="card-organic group cursor-pointer p-8 text-center bg-white shadow-organic hover:shadow-premium transition-all duration-600">
          <!-- Organic icon -->
          <div class="mb-6 relative">
            <div class="organic-shape organic-blob w-16 h-16 mx-auto bg-gradient-to-br from-lavender-400 to-lavender-600 flex items-center justify-center">
              <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
              </svg>
            </div>
            <div class="absolute -top-2 -right-2 w-4 h-4 bg-coral-400 rounded-full animate-pulse-organic opacity-70"></div>
          </div>
          <h3 class="text-xl font-bold mb-3 text-primary-700 group-hover:text-coral-500 transition-colors duration-300">
            1. Wizja lokalna
          </h3>
          <p class="text-sm font-semibold mb-3 text-coral-500">
            Zawsze wymagana
          </p>
          <p class="text-sm leading-relaxed text-neutral-600">
            Cały zespół (elektryk, hydraulik, wykończenia) jednocześnie. Bezpłatnie.
          </p>
        </div>

        <!-- USP 2: Wycena 24h -->
        <div class="card-organic group cursor-pointer p-8 text-center bg-white shadow-organic hover:shadow-coral transition-all duration-600">
          <!-- Organic icon -->
          <div class="mb-6 relative">
            <div class="organic-shape organic-flow w-16 h-16 mx-auto bg-gradient-to-br from-coral-400 to-coral-600 flex items-center justify-center">
              <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M16.2,16.2L11,13V7H12.5V12.2L17,14.9L16.2,16.2Z"/>
              </svg>
            </div>
            <div class="absolute -bottom-1 -left-1 w-3 h-3 bg-lavender-400 rounded-full animate-flow opacity-60"></div>
          </div>
          <h3 class="text-xl font-bold mb-3 text-primary-700 group-hover:text-lavender-500 transition-colors duration-300">
            2. Wycena w 24h
          </h3>
          <p class="text-sm font-semibold mb-3 text-coral-500">
            Szybka odpowiedź
          </p>
          <p class="text-sm leading-relaxed text-neutral-600">
            Szczegółowy breakdown kosztów. Bez ukrytych płatności. Jedna faktura.
          </p>
        </div>

        <!-- USP 3: Harmonogram i realizacja -->
        <div class="card-organic group cursor-pointer p-8 text-center bg-white shadow-organic hover:shadow-premium transition-all duration-600">
          <!-- Organic icon -->
          <div class="mb-6 relative">
            <div class="organic-shape organic-wave w-16 h-16 mx-auto bg-gradient-to-br from-primary-400 to-primary-600 flex items-center justify-center">
              <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 24 24">
                <path d="M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M19,19H5V8H19V19M16,10V12H8V10H16Z"/>
              </svg>
            </div>
            <div class="absolute -top-1 -right-1 w-5 h-5 bg-gold-300 opacity-50 rounded-full animate-organic"></div>
          </div>
          <h3 class="text-xl font-bold mb-3 text-primary-700 group-hover:text-primary-500 transition-colors duration-300">
            3. Harmonogram i realizacja
          </h3>
          <p class="text-sm font-semibold mb-3 text-coral-500">
            Dotrzymujemy terminów
          </p>
          <p class="text-sm leading-relaxed text-neutral-600">
            Dotrzymujemy terminów bo kontrolujemy cały proces. Jeden punkt kontaktu.
          </p>
        </div>

        <!-- USP 4: Gwarancja -->
        <div class="card-organic group cursor-pointer p-8 text-center bg-white shadow-organic hover:shadow-coral transition-all duration-600">
          <!-- Organic icon -->
          <div class="mb-6 relative">
            <div class="organic-shape organic-cloud w-16 h-16 mx-auto bg-gradient-to-br from-gold-400 to-gold-600 flex items-center justify-center">
              <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1M10,17L6,13L7.41,11.59L10,14.17L16.59,7.58L18,9L10,17Z"/>
              </svg>
            </div>
            <div class="absolute -bottom-2 -right-2 w-6 h-6 bg-primary-200 opacity-40 rounded-full animate-pulse-organic"></div>
          </div>
          <h3 class="text-xl font-bold mb-3 text-primary-700 group-hover:text-gold-500 transition-colors duration-300">
            4. Gwarancja 24 miesiące
          </h3>
          <p class="text-sm font-semibold mb-3 text-coral-500">
            Pełne zabezpieczenie
          </p>
          <p class="text-sm leading-relaxed text-neutral-600">
            17 lat doświadczenia = stabilny partner na lata. Serwis gwarancyjny.
          </p>
        </div>
      </div>

      <!-- Modern Organic CTA Section -->
      <div class="text-center mb-24 relative">
        <!-- Organic background accent -->
        <div class="absolute inset-0 bg-gradient-to-r from-primary-50 via-neutral-50 to-coral-50 rounded-organic-2xl -mx-8 py-12 opacity-60"></div>
        
        <div class="relative z-10 space-y-6 sm:space-y-0 sm:space-x-6 sm:flex sm:justify-center sm:items-center py-12">
          <Button 
            variant="primary-hero" 
            href="#kontakt"
            class="btn-primary-hero shadow-organic hover:shadow-coral transition-all duration-500"
          >
            <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
              <path d="M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M19,5V19H5V5H19M13.96,12.71L14.76,11.54L16.15,12.9L13.96,12.71M10.65,8.41L11.19,9.54L10.04,10.28L10.65,8.41M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10Z"/>
            </svg>
            Poproś o wycenę
          </Button>
          
          <Button 
            variant="secondary-hero" 
            href="tel:+48123456789"
            class="btn-secondary-hero glass-premium transition-all duration-500"
          >
            <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
              <path d="M6.62,10.79C8.06,13.62 10.38,15.94 13.21,17.38L15.41,15.18C15.69,14.9 16.08,14.82 16.43,14.93C17.55,15.3 18.75,15.5 20,15.5A1,1 0 0,1 21,16.5V20A1,1 0 0,1 20,21A17,17 0 0,1 3,4A1,1 0 0,1 4,3H7.5A1,1 0 0,1 8.5,4C8.5,5.25 8.7,6.45 9.07,7.57C9.18,7.92 9.1,8.31 8.82,8.59L6.62,10.79Z"/>
            </svg>
            Zadzwoń teraz
          </Button>
        </div>
        
        <!-- Floating organic accents -->
        <div class="absolute top-4 left-8 w-8 h-8 bg-lavender-200 opacity-30 rounded-full animate-float"></div>
        <div class="absolute bottom-4 right-8 w-6 h-6 bg-coral-200 opacity-40 rounded-full animate-organic"></div>
      </div>

      <!-- Modern Stats Section with Organic Flow -->
      <div class="text-center relative">
        <!-- Organic section header -->
        <div class="mb-12 relative">
          <h3 class="text-3xl font-bold text-primary-700 mb-4">
            PLANY w liczbach
          </h3>
          <div class="w-24 h-1 bg-gradient-to-r from-coral-400 to-lavender-400 mx-auto rounded-full"></div>
          
          <!-- Organic accent -->
          <div class="absolute -top-4 right-1/3 w-3 h-3 bg-gold-300 rounded-full animate-pulse-organic opacity-60"></div>
        </div>
        
        <!-- Stats grid with organic cards -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-4xl mx-auto">
          
          <!-- Stat 1: Specialists -->
          <div class="glass-organic p-8 text-center group hover:scale-105 transition-all duration-500">
            <div class="organic-shape organic-pebble w-20 h-20 mx-auto mb-6 bg-gradient-to-br from-coral-400 to-coral-600 flex items-center justify-center">
              <svg class="w-10 h-10 text-white" fill="currentColor" viewBox="0 0 24 24">
                <path d="M16 4C18.2 4 20 5.8 20 8S18.2 12 16 12 12 10.2 12 8 13.8 4 16 4M16 14C18.7 14 24 15.3 24 18V20H8V18C8 15.3 13.3 14 16 14M12.5 11.5C14.1 11.5 15.4 10.2 15.4 8.6S14.1 5.7 12.5 5.7 9.6 7 9.6 8.6 10.9 11.5 12.5 11.5M12.5 13.1C10.3 13.1 6 14.2 6 16.4V17.8H0V16.4C0 14.2 5.7 13.1 12.5 13.1Z"/>
              </svg>
            </div>
            <div class="text-4xl font-bold text-coral-500 mb-2">20+</div>
            <div class="text-sm font-medium text-neutral-600 uppercase tracking-wider">Specjalistów</div>
          </div>

          <!-- Stat 2: Experience -->
          <div class="glass-organic p-8 text-center group hover:scale-105 transition-all duration-500">
            <div class="organic-shape organic-fluid w-20 h-20 mx-auto mb-6 bg-gradient-to-br from-primary-400 to-primary-600 flex items-center justify-center">
              <svg class="w-10 h-10 text-white" fill="currentColor" viewBox="0 0 24 24">
                <path d="M5,16L3,14L5,12L6.5,13.5L11,9L16,14L20.5,9.5L22,11L16,17L11,12L6.5,15.5L5,16M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2Z"/>
              </svg>
            </div>
            <div class="text-4xl font-bold text-primary-600 mb-2">17</div>
            <div class="text-sm font-medium text-neutral-600 uppercase tracking-wider">Lat doświadczenia</div>
          </div>
          
          <!-- Stat 3: Projects -->
          <div class="glass-organic p-8 text-center group hover:scale-105 transition-all duration-500">
            <div class="organic-shape organic-wave w-20 h-20 mx-auto mb-6 bg-gradient-to-br from-lavender-400 to-lavender-600 flex items-center justify-center">
              <svg class="w-10 h-10 text-white" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M15.5,8A1.5,1.5 0 0,0 14,9.5A1.5,1.5 0 0,0 15.5,11A1.5,1.5 0 0,0 17,9.5A1.5,1.5 0 0,0 15.5,8M10,17L16,11L14.5,9.5L10,14L8.5,12.5L7,14L10,17Z"/>
              </svg>
            </div>
            <div class="text-4xl font-bold text-lavender-600 mb-2">100-5000m²</div>
            <div class="text-sm font-medium text-neutral-600 uppercase tracking-wider">Realizacje</div>
          </div>
        </div>
      </div>

    </div>
  </div>
</section>

<style>
  /* Modern Organic About Section */
  .about {
    position: relative;
  }

  /* Organic card hover effects */
  .about .card-organic:hover .organic-shape {
    transform: scale(1.1) rotate(5deg);
    transition: all 0.6s var(--ease-organic);
  }

  .about .card-organic:hover {
    transform: translateY(-8px);
  }

  /* Organic shape morphing on hover */
  .about .group:hover .organic-blob {
    border-radius: 40% 60% 70% 30% / 50% 60% 40% 50%;
  }

  .about .group:hover .organic-flow {
    border-radius: 30% 70% 40% 60% / 60% 40% 80% 20%;
  }

  .about .group:hover .organic-wave {
    border-radius: 70% 30% 30% 70% / 70% 70% 30% 30%;
  }

  .about .group:hover .organic-cloud {
    border-radius: 60% 40% 40% 60% / 40% 60% 60% 40%;
  }

  /* Enhanced text flow with organic elements */
  .about p {
    position: relative;
  }

  /* Stats section organic enhancements */
  .about .glass-organic:hover {
    backdrop-filter: blur(24px);
    background: rgba(255, 255, 255, 0.8);
  }

  /* Mobile responsiveness */
  @media (max-width: 768px) {
    .about .organic-decoration {
      opacity: 0.1 !important;
      animation: none;
    }
    
    .about .card-organic {
      padding: 1.5rem;
    }
    
    .about .glass-organic {
      padding: 1.5rem;
    }
  }
</style>

<script type="module">
  function initOrganicAboutAnimations() {
    if (!window.gsap || !window.ScrollTrigger) {
      // Fallback: show elements immediately
      document.querySelectorAll('.about .card-organic, .about .glass-organic, .about [class*="btn-"]').forEach(el => {
        if (el) {
          el.style.opacity = '1';
          el.style.transform = 'translateY(0) scale(1)';
        }
      });
      return;
    }

    gsap.registerPlugin(ScrollTrigger);

    // Check for reduced motion preference
    const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    if (prefersReducedMotion) {
      gsap.set('.about .card-organic, .about .glass-organic, .about [class*="btn-"]', { 
        opacity: 1, y: 0, scale: 1, rotation: 0 
      });
      return;
    }

    // Animate section header with organic flow
    gsap.fromTo('.about h2', 
      {
        opacity: 0,
        y: 30,
        scale: 0.95
      },
      {
        opacity: 1,
        y: 0,
        scale: 1,
        duration: 1,
        ease: 'power3.out',
        scrollTrigger: {
          trigger: '.about h2',
          start: 'top 85%',
          toggleActions: 'play none none reverse'
        }
      }
    );

    // Animate USP cards with organic stagger
    gsap.fromTo('.about .card-organic', 
      {
        opacity: 0,
        y: 50,
        scale: 0.9,
        rotation: -5
      },
      {
        opacity: 1,
        y: 0,
        scale: 1,
        rotation: 0,
        duration: 0.8,
        stagger: {
          amount: 0.6,
          from: 'start'
        },
        ease: 'back.out(1.1)',
        scrollTrigger: {
          trigger: '.about .grid',
          start: 'top 75%',
          toggleActions: 'play none none reverse'
        }
      }
    );

    // Animate CTA section with premium effect
    gsap.fromTo('.about [class*="btn-"]', 
      {
        opacity: 0,
        scale: 0.85,
        y: 30
      },
      {
        opacity: 1,
        scale: 1,
        y: 0,
        duration: 0.7,
        stagger: 0.15,
        ease: 'back.out(1.3)',
        scrollTrigger: {
          trigger: '.about [class*="btn-"]',
          start: 'top 80%',
          toggleActions: 'play none none reverse'
        }
      }
    );

    // Animate stats with organic morphing
    gsap.fromTo('.about .glass-organic', 
      {
        opacity: 0,
        scale: 0.8,
        y: 40
      },
      {
        opacity: 1,
        scale: 1,
        y: 0,
        duration: 0.9,
        stagger: {
          amount: 0.4,
          from: 'center'
        },
        ease: 'power2.out',
        scrollTrigger: {
          trigger: '.about .glass-organic',
          start: 'top 80%',
          toggleActions: 'play none none reverse'
        }
      }
    );

    // Organic decoration animations
    gsap.fromTo('.about .organic-decoration', 
      {
        opacity: 0,
        scale: 0.6,
        rotation: -20
      },
      {
        opacity: 1,
        scale: 1,
        rotation: 0,
        duration: 1.2,
        stagger: 0.2,
        ease: 'power2.out',
        scrollTrigger: {
          trigger: '.about',
          start: 'top 90%',
          toggleActions: 'play none none reverse'
        }
      }
    );

    // Setup organic hover interactions
    setupOrganicHoverEffects();
  }

  function setupOrganicHoverEffects() {
    const cards = document.querySelectorAll('.about .card-organic');
    const statsCards = document.querySelectorAll('.about .glass-organic');
    
    // Enhanced card interactions
    cards.forEach(card => {
      const organicShape = card.querySelector('.organic-shape');
      
      card.addEventListener('mouseenter', () => {
        if (typeof gsap !== 'undefined' && organicShape) {
          gsap.to(organicShape, {
            scale: 1.1,
            rotation: 8,
            duration: 0.4,
            ease: 'power2.out'
          });
        }
      });
      
      card.addEventListener('mouseleave', () => {
        if (typeof gsap !== 'undefined' && organicShape) {
          gsap.to(organicShape, {
            scale: 1,
            rotation: 0,
            duration: 0.4,
            ease: 'power2.out'
          });
        }
      });
    });

    // Stats cards organic interactions
    statsCards.forEach(card => {
      const organicShape = card.querySelector('.organic-shape');
      
      card.addEventListener('mouseenter', () => {
        if (typeof gsap !== 'undefined') {
          gsap.to(card, {
            y: -8,
            scale: 1.05,
            duration: 0.5,
            ease: 'power2.out'
          });
          
          if (organicShape) {
            gsap.to(organicShape, {
              scale: 1.15,
              rotation: 10,
              duration: 0.5,
              ease: 'back.out(1.2)'
            });
          }
        }
      });
      
      card.addEventListener('mouseleave', () => {
        if (typeof gsap !== 'undefined') {
          gsap.to(card, {
            y: 0,
            scale: 1,
            duration: 0.5,
            ease: 'power2.out'
          });
          
          if (organicShape) {
            gsap.to(organicShape, {
              scale: 1,
              rotation: 0,
              duration: 0.5,
              ease: 'power2.out'
            });
          }
        }
      });
    });
  }

  // Initialize when DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initOrganicAboutAnimations);
  } else {
    initOrganicAboutAnimations();
  }
</script>